# Development Dockerfile with additional tools
FROM python:3.12-slim

LABEL maintainer="Nathaniel Koranteng <kora.nathaniel@gmail.com>"
LABEL description="Development environment for GitLab Secrets Manager"

WORKDIR /app

ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1

# Install additional development tools
RUN apt-get update && apt-get install -y --no-install-recommends \
    git \
    vim \
    curl \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements
COPY requirements.txt .

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy application files (README.md needed by setup.py)
COPY setup.py README.md config.py gitlab_client.py gitlab_secrets.py ./

# Install package in development mode
RUN pip install --no-cache-dir -e .

# Create non-root user
RUN useradd -m -u 1000 appuser && \
    chown -R appuser:appuser /app

USER appuser

ENTRYPOINT ["python", "gitlab_secrets.py"]
CMD ["--help"]

